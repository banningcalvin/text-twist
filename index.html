<!DOCTYPE html>
<html>

<head>
  <style>
    .hidden {
      display: none;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Cinzel&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="index.css" />
</head>

<body>
  <h1 class='title'>TEXT-TWIST II:<br /> THE TWISTENING</h1>
  <div class='controls'>
    <button id="twist" class="button">TWIST</button>
    <button id="enter" class="button">ENTER</button>
    <button id="quit" class="button">END IT</button>
  </div>
  <form id="wordLable" for="wordHere">
    <div id="input">
      <label id="wordLable" for="wordHere">
        Input a guess:
      </label>
      <input id="wordHere" type="text" maxlength="25">
    </div>
    <div class="submitter">
      <button id="subButton" type="button">
        Check your guess!
      </button>
    </div>
  </form>
  <div>
    <p id="result"></p>
  </div>
  <div id="rack">
  </div>
</body>
<script>note
  $(function () {

    var secretWord = ""

    // replace with the backend php functions andy has to provide all subracks
    // and automatically choose one of those
    var shuffle = function (s) {
      let a = s.split(""),
        n = a.length;

      for (let i = n - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        let tmp = a[i];
        a[i] = a[j];
        a[j] = tmp;
      }
      return a.join("");
    }

    var showRack = function (words) { // maybe have this take in a word, that way it's not displaying the correct words, and then it shuffles it
      $("#rack").html('');
      words.map(word => {
        secretWord = word.word;
        let shuffled = shuffle(secretWord);
        
        $("#rack").append(`<li>${secretWord}</li>`);
        $("#rack").append(`<li>${shuffled}</li>`);
      });
    }

    var getGuess = function(){
      var guesser = document.getElementById("wordHere");
      var result = document.getElementById("result");
      var enterWaiter = guesser.addEventListener("keypress", function(k){
        if(k.keyCode == 13){
          var theWord = document.getElementById("wordHere").nodeValue;
          if(theWord.length == 0){
            alert("Guesses can NOT be empty");
          }
          else{
            $("#result").append('<li>${theWord}</li');
          }
        }
      });
    }

    $("#twist").on("click", function () {
    // for something like this to work, need to be able to save the current "correct answer" and its shuffled counterpart to a global list or variable that we can access at every time
    // This is primarily due to the fact that the "showRack" function is operated on in the local scope. 
    shuffled = shuffle(secretWord); // Not sure if this will actually work since it's not clear if the words are saved in the global scope
    });

    $("#enter").on("click", function () { // we can have this first as a start function and then as an "enter key" of sorts if that's what we want
      $.ajax({
        method: "GET",
        url: "api.php",
        success: data => { showRack(data) }
      });
      getGuess();
    });
  });
</script>

</html>