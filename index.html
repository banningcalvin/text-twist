<!DOCTYPE html>
<html>

<head>
  <style>
    .hidden {
      display: none;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Cinzel&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="index.css" />
</head>

<body>
  <h1 class='title'>TEXT-TWIST II:<br /> THE TWISTENING</h1>

  <div class='controls'>
    <button id="start" class="button">START</button>
    <button id="twist" class="button hidden">TWIST</button>
    <button id="enter" class="button hidden">ENTER</button>
  </div>
<<<<<<< HEAD
  <form id="wordLable" for="wordHere">
    <div id="input">
      <label id="wordLable" for="wordHere">
        Input a guess:
      </label>
      <input id="wordHere" type="text" maxlength="25">
    </div>
    <div class="submitter">
      <button id="subButton" type="button">
        Check your guess!
      </button>
    </div>
  </form>
  <div>
    <p id="result"></p>
  </div>
=======

>>>>>>> master
  <div id="rack">

  </div>

  <div id="result">

  </div>

  <div id="response">

  </div>

  <div id="remaining">
    Press Start to Begin
  </div>

  <div id="scoreTitle" class="hidden"><h2>Score:</h2></div>
  <div id="score" class="hidden">0</div>

  <div id="past" class="hidden">
    <h2>Correct Guesses:</h2>
  </div>

</body>
<<<<<<< HEAD
<script>note
  $(function () {
=======
<script>
  var game = function () {
    var self = this;

    var score = 0;

    var rack = [];
    var letterButtons = [];
    
    var validWords = [];
    var remaining = 0;
    
    var guess = "";



    this.clear = function () {
      this.guess = '';
      for (var i = 0; i < this.letterButtons.length; i++)
        this.letterButtons[i].disabled = false;
>>>>>>> master

      this.displayLetters();
    };

    this.displayLetters = function () { $('#result').text(this.guess); };

    this.getWords = function (response) {
      self.validWords = response.words;
      self.remaining = self.validWords.length;
      self.rack = response.letters;

      $("#start").hide();
      $("#remaining").text("Words Remaining: " + self.remaining);
      
      
      let letters = self.rack.split("");
      let prompt = 'CHOOSE LETTERS:<br \>';
      
      for (var i = 0; i < letters.length; i++) {
        prompt += '<button class="letter" letter="' + letters[i] + '">' + letters[i] + '</button>';
      }

<<<<<<< HEAD
    var showRack = function (words) { // maybe have this take in a word, that way it's not displaying the correct words, and then it shuffles it
      $("#rack").html('');
      words.map(word => {
        secretWord = word.word;
        let shuffled = shuffle(secretWord);
        
        $("#rack").append(`<li>${secretWord}</li>`);
        $("#rack").append(`<li>${shuffled}</li>`);
=======
      $("#rack").html(prompt);
      self.letterButtons = document.querySelectorAll('.letter');

      $("#past").removeClass("hidden");
      $("#score").removeClass("hidden");
      $("#scoreTitle").removeClass("hidden");

      $("#enter").removeClass("hidden");
      this.guess = "";
      for (let i = 0; i < this.letterButtons.length; i++) {
        this.letterButtons[i].addEventListener('click', function () {
          self.guess += this.getAttribute('letter');
          this.disabled = true;
          self.displayLetters();
        });
      }
      $("#enter").on('click', function () {
        self.checkGuess();
>>>>>>> master
      });
    };

<<<<<<< HEAD
    var getGuess = function(){
      var guesser = document.getElementById("wordHere");
      var result = document.getElementById("result");
      var enterWaiter = guesser.addEventListener("keypress", function(k){
        if(k.keyCode == 13){
          var theWord = document.getElementById("wordHere").nodeValue;
          if(theWord.length == 0){
            alert("Guesses can NOT be empty");
          }
          else{
            $("#result").append('<li>${theWord}</li');
          }
        }
      });
    }

    $("#twist").on("click", function () {
    // for something like this to work, need to be able to save the current "correct answer" and its shuffled counterpart to a global list or variable that we can access at every time
    // This is primarily due to the fact that the "showRack" function is operated on in the local scope. 
    shuffled = shuffle(secretWord); // Not sure if this will actually work since it's not clear if the words are saved in the global scope
    });

    $("#enter").on("click", function () { // we can have this first as a start function and then as an "enter key" of sorts if that's what we want
      $.ajax({
        method: "GET",
        url: "api.php",
        success: data => { showRack(data) }
      });
      getGuess();
=======
    this.checkGuess = function () {
      var length = this.validWords.length;
      var correct = false;
      
      for (var i = 0; i < length; i++) {
        if (this.validWords[i] != null && this.guess == this.validWords[i]) {
          this.validWords[i] = null;
          $("#past").append("" + this.guess + "<br>")
          score++;
          $("#score").html(score)
          correct = true;
          break;
        }
      }

      this.handleAnswer(correct);
    }

    this.handleAnswer = function (correct) {
      if (correct) {
        this.remaining--;
        if (this.remaining == 0) {
          $('#response').html('<h1>YOU SURVIVED. Refresh to play again.</h1>');
          return;
        }
        $("#response").text("YOU GUESSED CORRECTLY.");
        $("#remaining").text("Words Remaining: " + this.remaining);
      }
      else {
        $("#response").text("YOU GUESSED INCORRECTLY.");
      }
      this.clear();
    }

    $("#start").on('click', function () {
      var request = new XMLHttpRequest();
      request.onload = function () {
        self.getWords(JSON.parse(this.response));
      };
      request.open("GET", "api.php");
      request.send();
>>>>>>> master
    });
  }

  let newGame = new game();
</script>

</html>